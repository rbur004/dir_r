<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: DirR
  
    &mdash; dir_r
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "DirR";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (D)</a> &raquo;
    
    
    <span class="title">DirR</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: DirR
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">DirR</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/dir_r.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Recursive walk through a directory tree There is also Find.find and Dir.glob as alternatives Symbolic links, pointing nowhere, are ignored Symbolic links to directories are ignored  We will process the linked to directory, if it is in this tree;  But we don&#39;t want to break out of this tree, and go wondering through the file system. We also ignore special files (i.e. sockets, dev nodes, â€¦)</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VERSION-constant" class="">VERSION =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1.0.1</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#walk_dir-class_method" title="walk_dir (class method)">.<strong>walk_dir</strong>(directory:, walk_sub_directories: true, ignore_symlinks: true, debug: false) {|String, String, Boolean| ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Directory listing.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="walk_dir-class_method">
  
    .<strong>walk_dir</strong>(directory:, walk_sub_directories: true, ignore_symlinks: true, debug: false) {|String, String, Boolean| ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Directory listing. Ignoring symbolic links</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>directory</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>directory to list</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>walk_sub_directories</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Recurse through the subdirectories</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ignore_symlinks</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Skip over symbolic links to files</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>String</tt>, <tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Directory path, Filename, Symbolic Link true/false (only if ! ignore_symlinks)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/dir_r.rb', line 17</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_walk_dir'>walk_dir</span><span class='lparen'>(</span><span class='label'>directory:</span><span class='comma'>,</span> <span class='label'>walk_sub_directories:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>ignore_symlinks:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>debug:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>In </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_directory'>directory</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_debug'>debug</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_directory'>directory</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_filename'>filename</span><span class='op'>|</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> Got: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_debug'>debug</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_filename'>filename</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_filename'>filename</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span> <span class='comment'>#ignore parent, and current directories.
</span>      <span class='id identifier rubyid_qualified_filename'>qualified_filename</span> <span class='op'>=</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_directory'>directory</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_stat_record'>stat_record</span> <span class='op'>=</span>  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_stat'>stat</span><span class='lparen'>(</span><span class='id identifier rubyid_qualified_filename'>qualified_filename</span><span class='rparen'>)</span>  <span class='comment'>#File end
</span>        <span class='id identifier rubyid_lstat_record'>lstat_record</span> <span class='op'>=</span>  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_lstat'>lstat</span><span class='lparen'>(</span><span class='id identifier rubyid_qualified_filename'>qualified_filename</span><span class='rparen'>)</span><span class='comment'>#Link end 
</span>      <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Skipping </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_qualified_filename'>qualified_filename</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_debug'>debug</span>
        <span class='kw'>next</span> <span class='comment'># Link points nowhere, so we ignore it, rather than stop.
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_link'>link</span> <span class='op'>=</span> <span class='id identifier rubyid_lstat_record'>lstat_record</span><span class='period'>.</span><span class='id identifier rubyid_symlink?'>symlink?</span> 
      <span class='kw'>if</span> <span class='id identifier rubyid_stat_record'>stat_record</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_link'>link</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_walk_sub_directories'>walk_sub_directories</span> 
          <span class='comment'>#recurse through sub-directories.
</span>          <span class='comment'>#don&#39;t follow links to directories though, as they could take us anywhere, including looping.
</span>          <span class='id identifier rubyid_walk_dir'>walk_dir</span><span class='lparen'>(</span> <span class='label'>directory:</span> <span class='id identifier rubyid_qualified_filename'>qualified_filename</span><span class='comma'>,</span>
                    <span class='label'>walk_sub_directories:</span> <span class='id identifier rubyid_walk_sub_directories'>walk_sub_directories</span><span class='comma'>,</span> 
                    <span class='label'>ignore_symlinks:</span> <span class='id identifier rubyid_ignore_symlinks'>ignore_symlinks</span><span class='comma'>,</span> 
                    <span class='label'>debug:</span> <span class='id identifier rubyid_debug'>debug</span><span class='comma'>,</span>
                    <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
                  <span class='rparen'>)</span>
          <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Back In </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_directory'>directory</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_debug'>debug</span>
        <span class='kw'>end</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_stat_record'>stat_record</span><span class='period'>.</span><span class='id identifier rubyid_file?'>file?</span> 
        <span class='comment'># Ordinary file and not a link, or we are accepting links
</span>        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_ignore_symlinks'>ignore_symlinks</span>
          <span class='kw'>yield</span> <span class='id identifier rubyid_directory'>directory</span><span class='comma'>,</span> <span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_link'>link</span>
        <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_link'>link</span>
          <span class='kw'>yield</span> <span class='id identifier rubyid_directory'>directory</span><span class='comma'>,</span> <span class='id identifier rubyid_filename'>filename</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Nov  3 13:38:24 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.7.1).
</div>

    </div>
  </body>
</html>